[TOC]

# 纯函数定义
纯函数就是相同的输入永远得到相同的输出，且没有可观测的副作用。
> 比如`slice`和`splice`

在函数式编程中我们追求不改变数据的纯函数写法。

纯函数写法，我们应当尽可能减少对外部环境的依赖，比如:
```js
// 不纯的
var minimum = 21;
var checkAge = function(age) {
  return age >= minimum;
};

// 纯的
var checkAge = function(age) {
  var minimum = 21;
  return age >= minimum;
};
```
我们可以看到，不纯的写法中，它的确没有产生副作用，然而它在内部使用了外部变量，这会产生两点坏处：
1. `minimum`处于外部环境，可以被很多函数访问到，处于外部环境的变量是不能被随意更改的，比如这里，假设有多个同时使用了这个变量，因为业务需求的改变，某函数A使用的此变量需要改为`100`。处于外部环境的`minimum`就不能被随意修改，一旦修改，所有使用此外部状态的函数都会收到影响
> 基于这一点，在外部使用的变量，应该保证其不可变
2. 引入了外部环境，增加了认知负担。考虑一种情况，现在`minimum`变量被多个函数所使用，在某个函数A中因副作用改变了`minimum`的值，使用到`minimum`的函数都被影响了，开发者观测到某个函数B的运行出现了异常，函数B本身是没有副作用的，逻辑也正常。
现在想要修复这个bug就变得复杂了，事情没有那么简单，
    1. 首先开发者可能得花费一段时间才能确认这个函数本身逻辑没有问题，问题出在外部状态。
    2. 如果只有外部状态`minimum`，我们需要查看所有使用到`minimum`的函数，这本身就很麻烦，如果使用 `minimum`的函数都集中在同一个文件中可能场景要简单些，我们在文件中查看所有使用到此状态的函数
    3. 不可避免地，有些内部状态使用了和外部状态同样的名称`minimum`
    4. 极端情况下，声明的变量是个比较通用的名字，那就很恶心了
    5. 如果在多个文件中有函数使用了此变量，那就更加恶心了，全局搜索`minimum`极大可能遇到其他内部变量或外部变量使用此名称，那么我们想找到使用相应外部变量`minimum`的函数都很麻烦。
    6. 以上是只使用一个外部状态的情况，如果函数B使用了多个外部状态呢？复杂度会再加上一个系数。
> 因此引入外部环境是非常危险的，平时可能感觉不到，一旦出现问题，想要追查问题就很恶心了。
3. 移植成本高，难以移植

相比较之下，我们可以看出纯函数的好处：
1. 方便维护。相关状态都在函数内部了，容易看出逻辑上的问题，修改状态也不会影响到其他地方，安全。
2. 方便移植，相关状态都在函数内部了，直接拿走就可以。